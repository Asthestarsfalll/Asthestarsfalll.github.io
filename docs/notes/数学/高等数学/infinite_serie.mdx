---
title: 无穷级数
tags:
  - Advanced
  - Mathematics
hide_table_of_contents: false
---

## 常数项级数

:::tip

设有数列 $\{u_{n}\}$，则称

$$
\sum_{n=1}^\infty u_{n}=u_{1}+u_{2}+\cdots+u_{n}+\cdots
$$

为无穷级数，令 $S_{n}=u_{1}+u_{2}+\cdots+u_{n}$，则称数列 $\{S_{n}\}$ 为级数的 **部分和数列**，如果部分和数列有极限 $S$，即

$$
\lim_{ n \to \infty } S_{n}=S
$$

则称级数 $\sum_{n=1}^\infty u_{n}$ 收敛于 $S$，此时称 $r_{n}=S-S_{n}=u_{n+1}+\cdots$ 为级数的 **余部**。

:::

显然，如果级数收敛，则

$$
\lim_{ n \to \infty } r_{n}=0
$$

**相关定理**

若 $k$ 为非零常数，则 $\sum_{n=1}^\infty u_{n}$ 与 $\sum_{n=1}^\infty ku_{n}$ 同敛散；

**可加性**：若两个级数分别收敛于 $A,B$，则级数之和收敛于 $A+B$；

两个级数中的任意一个级数发散，则级数之和一定 **发散**；

若两个级数都发散，则级数之和可能发散，也可能收敛；

去掉、增加、改变级数的 **有限项** 不影响级数的敛散性；

收敛级数任意加 **括号** 仍收敛，且和不变；

:::info 括号

在原有级数里随意将若干项用括号括起来看作新级数的一项；在原级数里这样添加的括号可以是有限个，也可以是无限个，只要原级数收敛，添加括号后得到的新级数就一定收敛。但请注意：原来带括号收敛的级数，去掉括号后却未必仍收敛；带括号发散的级数，原级数一定发散。

:::

级数收敛的必要条件是 $\lim_{ n \to \infty } u_{n}=0$，即级数收敛，通项趋于零；通常使用其逆否命题，若 $\lim_{ n \to \infty } u_{n}\neq0$，则级数一定不收敛。

:::info

若 $\lim_{ n \to \infty }u_{n}\neq 0$，则级数发散

:::

### 正项级数的判敛准则

:::tip 正项级数

各项都是正数的级数，若各项都是负数，可以乘以 $-1$ 转化为正项级数，敛散性相同。

:::

**定理**

**部分和有界** 是正向级数收敛的充要条件；

**比较判别法**：若两正项级数 $\sum_{n=1}^\infty u_{n}， \sum_{n=1}^\infty v_{n}$，存在某个正数 $N$，当 $n>N$ 时，$u_{n}\leq v_{n}$，则

1. 若 $\sum_{n=1}^\infty v_{n}$ 收敛，则 $\sum_{n=1}^\infty u_{n}$ 收敛；
2. 若 $\sum_{n=1}^\infty u_{n}$ 发散，则 $\sum_{n=1}^\infty v_{n}$ 发散。

:::info 比较判别法的推论

极限形式，由于前有限项并不影响级数的敛散性，因此可以找到某一项之后的所有项都满足比较的条件即可，设

$$
\lim_{ n \to \infty } \frac{u_{n}}{v_{n}}=l, \ (0\leq l\leq+\infty)
$$

若 $l=0$， $\sum_{n=1}^\infty v_{n}$ 收敛，则 $\sum_{n=1}^\infty u_{n}$ 收敛；

若 $l=+\infty$，$\sum_{n=1}^\infty u_{n}$ 发散，则 $\sum_{n=1}^\infty v_{n}$ 发散；

若 $0<l<\infty$，二者同敛散。

:::

**比值判别法**：比较通项的无穷项，设

$$
\lim_{ n \to \infty } \frac{u_{n+1}}{u_{n}}=\rho
$$

若 $\rho=1$，敛散不确定；若 $\rho>1$，发散；若 $\rho<1$，收敛。

**根值判别法**：开 $n$ 次根号，设

$$
\lim_{ n \to \infty } \sqrt[n]{ u_{n} }=\rho
$$

若 $\rho=1$，敛散不确定；若 $\rho>1$，发散；若 $\rho<1$，收敛。

若 $\rho=1$，可能是通项趋近于一个常数，比值判别法也是同理，这时可以检查一下 $u_{n}$ 是否趋向于 $0$.

根值判别法中常用的一个极限为

$$
\lim_{ n \to \infty }\frac{\sqrt[n]{n!}}{n}
$$

可以使用定积分定义求解

$$
\begin{aligned}
&\sqrt[n]{ \frac{1}{n} \frac{2}{n}\cdots \frac{n}{n} }\\
&=e^{\frac{1}{n}\sum_{k=1}^\infty \ln \frac{k}{n}}\\
&=e^{\int _{0}^1\ln x \, dx }\\
&=\frac{1}{e}
\end{aligned}
$$

**stolz 定理**：能用比值判别法做出来，则一定能用根值判别法做出来。

若 $b_{n}$ 递增，且 $\lim_{ n \to \infty }b_{n}=+\infty$，则

$$
\lim_{ n \to \infty } \frac{a_{n+1}-a_{n}}{b_{n+1}-b_{n}}=\lim_{ n \to \infty } \frac{a_{n}}{b_{n}}=A
$$

实际上根值判别法是可以转化为这种形式。

**斯特林公式**：阶乘的估计

$$
n! \approx \sqrt{ 2\pi n }\left(\frac{n}{e}\right)^n
$$

**指数求和等价无穷大**：

$$
1^p+2^p+\cdots+n^p \sim \frac{n^{p+1}}{p+1}
$$

证明可以使用定积分定义。

**积分判别法**：若 $f(x)$ 在区间 $[1,+\infty)$ 是正的，且单调递减，则级数 $\sum_{n=1}^\infty f(n)$ 收敛，当且仅当反常积分 $\int _{1}^{+\infty}f(x) \, dx$ 收敛。

证明大致步骤如下：

1. 首先设中间函数 $F\left( x\right)=\int_{1}^\infty f(x)  \, dix$，这里的 $n$ 为正整数，利用夹逼准则可以证明其和上述反常积分同敛散；
2. 证明级数 $\sum_{n=1}^\infty\left(\sum_{k=1}^n f(k)-\int _{1}^nf(t) \, dx\right)$ 收敛，先证明单调，再将积分拆分为一个个区间（和积分的原理有关），则二者同敛散；

可以使用积分判别法证明，级数 $\sum_{n=1}^\infty \frac{1}{n^p}$ 当 $p>1$ 时收敛；当 $p\leq 1$ 时发散。

注意这里的积分下限是可以大于 $1$ 的。

**对数判别法**：$\lim_{ n \to \infty } \frac{\ln \frac{1}{a_{n}}}{\ln n}=\rho$，则

若 $\rho=1$，敛散不确定；若 $\rho<1$，发散；若 $\rho>1$，收敛；注意，这里的结论是相反的，可以使用极限保号性证明。

### 交错级数

:::tip 交错级数

符号正负相间的级数，即 $\sum_{n=1}^\infty (-1)^{n-1}u_{n},\ u_{n}>0$，则称此级数为 **交错级数**。

:::

**莱布尼茨准则**： 若 $u_{n}\geq u_{n+1}(n=1,2,\cdots)$，$\lim_{ n \to \infty } u_{n}=0$，则交错级数收敛。

:::caution

莱布尼茨准则是一个充分条件，即若交错级数收敛，则 $u_{n}\geq u_{n+1}(n=1,2,\cdots)$ 不一定成立，同样的不需要从第一项开始递减，只需要从有限项递减即可；

说明 $u_{n}>u_{n+1}$ 一般有三种方式：

1. 比值；
2. 作差；
3. 找出对应的可导函数，导函数小于零。

:::

### 绝对收敛

:::tip

若级数各项 **绝对值** 组成的级数收敛，则称其 **绝对收敛**；

若级数收敛，但不绝对收敛，则称其 **相对收敛**；

:::

**定理**

绝对收敛的级数一定收敛；

条件收敛的所有正项（负项）构成的级数一定发散，即：若级数条件收敛，则 $\sum_{n=1}^\infty \frac{u_{n}+|u_{n}|}{2}$ 和 $\sum_{n=1}^\infty \frac{u_{n}-|u_{n}|}{2}$ 都发散。

**常用结论**

1. 绝对收敛 $\pm$ 条件收敛 $=$ 条件收敛；
2. 绝对收敛 $\pm$ 绝对收敛 $=$ 绝对收敛；
3. 条件收敛 $\pm$ 条件收敛 $=$ 条件收敛或绝对收敛；

## 幂级数

:::tip 函数项级数及收敛域与和函数

设 $u_{1}(x),u_{2}(x),\cdots,u_{n}(x)$ 是定义在区间 $I$ 上的函数序列，则称

$$
u_{1}(x)+u_{2}(x)+\cdots+u_{n}(x)+\cdots=\sum_{n=1}^\infty u_{n}(x)
$$

为定义在区间 $I$ 上的 **函数项级数**。

若 $x_{0}\in I$，级数 $\sum_{n=1}^\infty u_{n}(x_{0})$ 收敛，则称 $x_{0}$ 为级数的 **收敛点**，否则就成为 **发散点**，所有收敛点构成的集合称为 **收敛域**。

函数项级数在收敛域内有和，其值与收敛点 $x$ 有关，记为 $S(x)=\sum_{n=1}^\infty u_{n}(x)$，又称为和函数。

:::

:::tip 幂级数

形如 $\sum_{n=0}^\infty a_{n}(x-x_{0})^n$ 的函数项级数成为 **幂级数**，注意这里的 $n$ 从 $0$ 开始，当 $x_{0}=0$ 时，$\sum_{n=0}^\infty a_{n}x^n$.

幂级数的收敛性只有三种情况：

1. 对于任意的 $x\in(-\infty,\infty)$ 都收敛；
2. 仅在 $x=0$ 处收敛；
3. 存在一个正数 $R$，当 $|x|<R$ 时绝对收敛，否则发散。
:::

### 定理

**阿贝尔定理**：幂级数 $\sum_{n=0}^\infty a_{n}x^n$ 当 $x=x_{0}\neq 0$ 时收敛，则当 $|x|<|x_{0}|$ 时，其绝对收敛；若幂级数发散，则当 $|x|>|x_{0}|$ 时，其发散。

**收敛半径、收敛区间**：若存在 $R$，使得 $\sum_{n=0}^\infty a_{n}x^n$ 在 $(-R,R)$ 内收敛，区间之外发散，则称 $R$ 为收敛半径，区间为收敛区间。

:::caution

注意这里是开区间，收敛需要判断端点是否收敛。

:::

若 $\lim_{ n \to \infty } | \frac{a_{n+1}}{a_{n}}|=\rho$，则 $R= \frac{1}{\rho}$.

若 $\lim_{ n \to \infty } \sqrt[n]{|a_n|}=\rho$，则 $R= \frac{1}{\rho}$.

:::caution

对于全是次数全是奇/偶的幂级数，形如

$$
\begin{aligned}
&\sum _{n=0}^\infty a_{n}x^{2n} \\
&\sum _{n=0}^\infty a_{n}x^{2n+1}
\end{aligned}
$$

收敛半径的需要额外开个根号 $R=\sqrt{ \frac{1}{\rho} }$.

:::

### 幂级数的性质

**四则运算性质**

两个收敛的幂级数之和/积，新的级数收敛于原级数极限之和/积，收敛半径取小者。

两个幂级数的和函数之比为

$$
\frac{S_{1}(x)}{S_{2}(x)}= \frac{\sum_{n=0}^\infty a_{n}x^n}{\sum_{n=0}^\infty b_{n}x^n}=c_{0}+c_{1}x+\cdots+c_{n}x^n+\cdots
$$

其中 $b_{0}\neq 0$，$c_{n}$ 由 $\sum_{n=0}^\infty b_{n}x^n\sum_{n=0}^\infty c_{n}x^n=\sum_{n=0}^\infty a_{n}x^n$ 确定。

设幂级数 $\sum_{n=0}^\infty a_{n}x^n$ 的收敛半径为 $R$，和函数为 $S(x)$，则

1. $S(x)$ 在 $(-R,R)$ 上连续；
2. $S(x)$ 在 $(-R,R)$ 上可导，且可逐项求导，即 $S'(x)=\sum_{n=1}^\infty na_{n}x^{n-1}$；
3. $S(x)$ 在 $(-R,R)$ 内可积，且可逐项积分，即 $\int_{0}^x S(t)dt=\sum_{n=0}^\infty \int_{0}^x a_{n}t^{n}dt=\sum_{n=0}^\infty \frac{a_{n}}{n+1}x^{n+1}$.

:::caution

两个幂级数之和的收敛半径需要分类讨论：

1. 当 $R_{1}=R_{2}$ 时，收敛半径 $R\geq min(R_{1},R_{2})$；
2. 当 $R_{1}\neq R_{2}$ 时，收敛半径 $R=min(R_{1},R_{2})$.

由于两收敛半径相同时，新级数的收敛半径可能会大于二者最小的收敛半径，因此实际收敛区间可能更大。

:::

### 函数的幂级数展开

就是泰勒公式，在 $x_{0}=0$ 处的级数展开称为 **麦克劳林级数**。

:::tip 泰勒级数的收敛

函数 $f(x)$ 在 $x=x_{0}$ 处任意阶可导，则泰勒级数

$$
\sum_{n=0}^\infty \frac{f^{(n)}(x_{0})}{n!}(x-x_{0})^n
$$

收敛于 $f(x)$ 的 **充要条件** 是

$$
\lim_{ n \to \infty } R_{n}(x)=0
$$

其中

$$
R_{n}(x)= \frac{f^{(n+1)}(x_{0}+\theta(x-x_{0}))}{(n+1)!}(x-x_{0})^{n+1}
$$

:::

**常用的麦克劳林展开式**

$$
\begin{aligned}
\frac{1}{1-x}&=1+x+x^2+\cdots+x^n,\ x \in (-1, 1)\\

\frac{1}{1+x}&=1-x+x^2+\cdots+(-1)^nx^n,\ x \in (-1,1)\\

e^x &=1+x+ \frac{x^2}{2}+\cdots+ \frac{x^n}{n!}\\

\sin x &=x- \frac{x^3}{3} +\cdots+\frac{(-1)^n}{(2n+1)!} x^{2n+1} \\

\cos x &= 1- \frac{x^2}{2}+\cdots+ \frac{(-1)^n}{(2n)!} x^{2n} \\
\ln(1+x) &= x- \frac{x^2}{2}+\cdots+ \frac{(-1)^{n-1}}{n} x^n \\
(1+x)^{\alpha} &= 1+\alpha x+\frac{\alpha(\alpha-1)}{2!}x^2+\cdots+\frac{\alpha(\alpha-1)\cdots(\alpha-n+1)}{n!}x^n \\
\arctan x &= \sum_{n=0}^{\infty} \frac{(-1)^n}{2n+1} x^{2n+1}\\
\arcsin x &= \sum_{n=0}^{\infty} \binom{2n}{n} \frac{1}{4^n (2n+1)} x^{2n+1}
\end{aligned}
$$

## 傅里叶级数

:::tip

设函数 $f(x)$ 是周期为 $2\pi$ 的周期函数，且在 $[-\pi,\pi]$ 上可积，则称

$$
\begin{aligned}
a_{n}= \frac{1}{\pi}\int_{-\pi}^\pi f(x)\cos nx  \, dx (n=0,1,2,\cdots),\\
b_{n}= \frac{1}{\pi}\int_{-\pi}^\pi f(x)\sin nx  \, dx (n=1,2,3,\cdots),\\
\end{aligned}
$$

为 $f(x)$ 的傅里叶系数，称级数 $\frac{a_{0}}{2}+\sum_{n=1}^\infty(a_{n}\cos nx+b_{n}\sin nx)$ 为其以 $2\pi$ 为周期的傅里叶级数。

:::

### 傅里叶级数的收敛性/狄利克雷收敛定理

若 $f(x)$ 是周期为 $2\pi$ 的可积函数，且满足

1. 在 $[-\pi,\pi]$ 上连续，或只有 **有限个** 第一类间断点；
2. 在 $[-\pi,\pi]$ 上只有有限个单调区间

则 $f(x)$ 的以 $2\pi$ 为周期的傅里叶级数收敛，且

$$
S(x)= \frac{a_{0}}{2}+\sum_{n=1}^\infty (a_{n}\cos nx+b_{n}\sin nx)=\frac{1}{2}[f(x^+)+f(x^-)]
$$

傅里叶级数在 $[-\pi,\pi]$ 上处处收敛，且收敛于

1. $f(x)$，$x$ 为连续点;
2. $\frac{f(x^-)+f(x^+)}{2}$，间断点；
3. $\frac{f(-\pi^+)+f(\pi^-)}{2}$，$x=\pm\pi$，因为周期是 $2\pi$，实际上是间断点的变形。

### 周期为 $2\pi$ 的函数的展开

在 $[-\pi,\pi]$ 上展开

$$
\begin{aligned}
a_{n}= \frac{1}{\pi}\int_{-\pi}^\pi f(x)\cos nx  \, dx (n=0,1,2,\cdots),\\
b_{n}= \frac{1}{\pi}\int_{-\pi}^\pi f(x)\sin nx  \, dx (n=1,2,3,\cdots),\\
\end{aligned}
$$

在 $[-\pi,\pi]$ 上奇偶函数的展开

若 $f(x)$ 为奇函数，

$$
\begin{aligned}
a_{n} &= 0, n=0,1,2,\cdots\\
b_{n}&=\frac{2}{\pi }\int_{0}^\pi f(x)\sin nx  \, dx(n=1,2,3,\cdots)
\end{aligned}
$$

$f(x)$ 为偶函数,

$$
\begin{aligned}
a_{n}&=\frac{2}{\pi }\int_{0}^\pi f(x)\cos nx  \, dx (n=0,1,2,\cdots)\\
b_{n} &= 0, n=1,2,\cdots\\
\end{aligned}
$$

在 $[0,\pi]$ 上展开为正弦或余弦：和上面的两种情况相同。

### 周期为 $2l$ 的函数的展开

只需将区间放缩至 $[-\pi,\pi]$ 之间即可，即

1. 修改积分上下限中的 $\pi$ 为 $l$；
2. 修改三角函数中的 $nx$ 为 $nx\cdot \frac{\pi}{l}$.
其余与上一节保持一致

## 级数求和

幂级数求和通常使用泰勒公式去除求和符号，或者找出通项的原函数，若原函数满足某个泰勒公式，则转换之后再求导。

常数项级数通常转化为幂级数在某一点的值进行求解。

求幂级数的和函数一般有三种方法：

1. 先导后积、先积后导；
2. 构造微分方程；
3. 套用公式。

### 公式法

:::info 武器库

$$
\frac{1}{1-x}=1+x+x^2+\cdots+x^n+\cdots=\sum_{n=0}^\infty x_{n},\ x \in(-1, 1)\\ \tag1
$$

由此可以推出

$$
\frac{1}{1+x}=1-x+x^2+\cdots+(-1)^nx^n+\cdots=\sum_{n=0}^\infty (-1)^n x_{n},\ x \in(-1, 1)\\
$$

积分推得

$$
\ln(1+x)=x-\frac{x^2}{2}+\frac{x^3}{3}-\frac{x^4}{4}+\cdots+(-1)^n \frac{x^n}{n}+\cdots=\sum_{n=1}^\infty (-1)^{n-1} \frac{x^n}{n}
$$

注意这里的 $n$ 是从 $1$ 开始的，因为 $0$ 是分母不成立，可以随意转换，如改为 $\sum_{n=0}^\infty (-1)^{n} \frac{x^{n+1}}{n+1}$

可以推出

$$
\ln(1-x)=-x-\frac{x^2}{2}-\frac{x^3}{3}-\frac{x^4}{4}-\cdots-\frac{x^n}{n}+\cdots=-\sum_{n=1}^\infty  \frac{x^n}{n}
$$

因此有常用公式

$$
\sum_{n=1}^\infty \frac{x^n}{n}=-\ln(1-x)
$$

若将 $\ln(1-x)$ 和 $\ln(1+x)$ 相加，则

$$
\ln(1+x^2)=-2\left(\frac{x^2}{2}+\frac{x^4}{4}+\cdots\frac{x^{2n}}{2n}+\cdots\right)=-2\sum_{n=1}^\infty  \frac{x^{2n}}{2n}
$$

相减得到

$$
\ln\left( \frac{1+x}{1-x} \right)=2\left(x+\frac{x^3}{3}+\cdots\frac{x^{2n+1}}{2n+1}+\cdots\right)=2\sum_{n=0}^\infty  \frac{x^{2n+1}}{2n+1}
$$

通过 $\frac{1}{1+x}$ 可以得到 $\frac{1}{1+x^2}$ 的泰勒展开，积分得到

$$
\arctan x=x-\frac{x^3}{3}+\frac{x^5}{5}-\frac{x^7}{7}+\cdots=-\sum_{n=1}^\infty (-1)^{n-1} \frac{x^{2n-1}}{2n-1}
$$

若对 $(1)$ 式求导

$$
\frac{1}{(1-x)^2}=\left(\sum_{n=0}^\infty x^n \right)'=\sum_{n=1}^\infty nx^{n-1}=\sum_{n=0}^\infty (n+1)x^{n} \tag2
$$

再次求导

$$
\frac{2}{(1-x)^3}=\sum_{n=1}^\infty (n+1)nx^{n-1}=\sum_{n=0}^\infty (n+2)(n+1)x^{n} \tag3
$$

可得得到规律

$$
\frac{(k-1)!}{(1-x)^k}=\sum_{n=0}^\infty (n+k)(n+k-1)\cdots(n+1)x^{n}
$$

该式通常需要配合拆项、裂项使用。

:::

级数求和时，可以使用裂项、求导、积分等方式凑出这些公式进行求解，只要形如 $g(x)x^n$，$g(x)$ 是关于 $n$ 的线性函数，则可以用待定系数法拆分为 $(2),(3)$ 式。

:::caution

需要尤其注意求和符号的起始点，要 **多退少补**，一般最多就补三项。

:::

### 构造微分方程

考虑两个例子

求解 $1+x+\frac{x^2}{2!}+\cdots+ \frac{x^n}{n!}+\cdots$ 的对应幂函数。

先对其求一次导得到 $0+1+x+\frac{x^2}{2!}+\cdots+ \frac{x^n}{n!}+\cdots$，可以发现和原级数相同，则可以得到微分方程

$$
S(x)=S'(x)
$$

根据初值条件得到 $\sum \frac{x^n}{n!}=e^x$.

求解 $x-\frac{x^3}{3!}+\frac{x^5}{5!}+\cdots+(-1)^n \frac{x^{2n+1}}{(2n+1)!}$ 的对应函数

求导得到

$$
1-\frac{x^2}{2!}+\cdots
$$

注意到 $x$ 由奇次数变为偶次数，可再次求导，不难发现结果是原式的取负，则得到微分方程

$$
S''(x)+S(x)=0
$$

则其对应幂函数是 $\sin x$

### 通过递推关系

通过递推关系构造微分方程求 $S(x)$，如 ${a_{n}}$ 满足 $a_{0}=3,a_{1}=1,a_{n-2}-n(n-1)a_{n}=0(n\geq 2),S(x)=\sum_{n=0}^\infty a_{n}x^n$ ，

1. 证明 $S''(x)=S(x)$
2. 求 $S(x)$

第一问求两次导即可，第二个解微分方程，代入初始条件。
