---
title: 双元积分法
tags: [Advanced Mathematics]
hide_table_of_contents: false
---

## 前言

参考： https://zhuanlan.zhihu.com/p/443599480

:::warning

不定积分方法本质上只有一种，就是凑微分。所谓的换元都是为了 **方便** 凑微分。从更方便这个角度来看，双元法的确比一些方法更简洁；双元法其实并不是一个独立的方法，它既可以看成三角换元的推广，也可以看成组合积分法的拓展，也是一种特殊的凑微分。

双元法会降低你的思考消耗，在你还没到达“注意到”之神的水平时，给予 **对称性的提示与结构的简明**。

:::

:::warning

下面的教程中的不定积分不会添加任何的 $C$.

:::

## 双元符号

:::tip 什么是双元符号

基于 **双元平等** 的前提，即被积函数和积分函数平等，形如

$$
\int  pdq
$$

而不是

$$
\int f(x) \, dx 
$$

将 $f(x)$ 视为主导。

:::

最常见的一个 **双元** 为

$$
pdq+qdp=d(pq)
$$

令 $p=f(x),q=x$，则可以得到一个很眼熟的式子

$$
f(x)dx+xdf(x)=f(x)dx+xf'(x)dx=d(xf(x))
$$

因此双元的显著特点就是：具备一定的“对称性”，且其结构突出，因此只有满足这些要求的才能使用双元积分法。

## 双元类型

### 三角型双元

最普通的双元，一般说的双元就是这一对

$$
x^2\pm y^2=C\iff xdx\pm ydy=0 \tag1
$$

若 $x,y$ 都是关于 $t$ 的函数，则

$$
2x(t)x'(t) + 2y(t)y'(t)=0\implies xdx+ydy=0
$$

一个最简单的使用技巧（当然没有这个必要）是求解 $(\sqrt{ 1+x^2 })'$，基本方法是使用符合函数求导法则；可以令 $y=\sqrt{ 1+x^2 }$，则 $y^2-x^2=1$，符合上述双元的特征，则

$$
xdx=ydy\iff \frac{d(\sqrt{ 1+x^2 })}{dx}=\frac{dy}{dx}=\frac{x}{y}=\frac{x}{\sqrt{ 1+x^2 }}
$$

:::info 实圆和虚圆

式 $(1)$ 中符号为正时，则称其为 `实圆`，记作 $Re$；若为负，则为 `虚圆`，记作 $Im$.    $\{\cos x, \sin x\}$ 就是一对实圆双元。

:::

**合分比性质**

向糖水中加入/减少相同浓度的糖水浓度不变，对于虚圆，我们有 $\frac{dx}{y}=\frac{dy}{x}$，可以进一步推广

$$
\frac{dx}{y}=\frac{dy}{x}=\frac{dx\pm dy}{y\pm x}=\frac{d(x\pm y)}{x\pm y}
$$

对等式上下同乘 $x，y$ 可以得到：

$$
\frac{dx}{y}=\frac{dy}{x}=\frac{ydx}{y^2}=\frac{xdy}{x^2}\iff \frac{dx}{y}=\frac{ydx-xdy}{y^2-x^2}
$$

同理，对于实圆有：

$$
\frac{dx}{y}=\frac{dx-dy}{y+x}= \frac{ydx-xdy}{y^2+x^2}
$$

### 第一公式

$$
\begin{aligned}
&[Im]\int  \frac{dx}{y}=\int \frac{dx+dy}{y+x}=\int \frac{d(x+y)}{x+y}=\ln|x+y|\\
&[Re]\int  \frac{dx}{y}=\int \frac{ydx-xdy}{x^2+y^2}=\int \frac{y^2}{x^2+y^2}d\left( \frac{x}{y} \right)=\int  \, \frac{d(x/y)}{1+x^2/y^2}=\arctan \frac{x}{y}
\end{aligned}
$$

总结一下就是

$$
\int \frac{dx}{y}=\begin{cases}
\ln|x+y|\ \ [Im] \\ \\
\arctan \frac{x}{y}\ \  [Re]
\end{cases} \tag2
$$

**小练一下**

$$
\int  \frac{d(\sin x)}{\sqrt{ a^2-\sin^2 x }}
$$

$$
\int  \frac{d(x^{2023})}{\sqrt{ 4+x^{4046} }}
$$

$$
\int \frac{1}{2\sqrt{ 1+x }}\arctan \sqrt{ \frac{1+x}{1-x} } \, dx 
$$

这一题需要先凑微分、再分布积分，逆用第一公式即可。

### 第三公式

讨论 $\int \frac{dx}{y^3}$ ，对于虚元，有以下公式

$$
\begin{aligned}
\int \frac{dx}{y^3}&=\int  \frac{1}{y^2} \frac{dx}{y}\\&=\frac{1}{y^2-x^2}\int  \frac{y\ dx-x\ dy}{y^2}\\&=\frac{1}{y^2-x^2}\int d \left( \frac{x}y{} \right)\\&=\frac{1}{y^2-x^2} \frac{x}{y}
\end{aligned}
$$

对于实圆：

$$
\begin{aligned}
\int \frac{dx}{y^3}&=\int  \frac{1}{y^2} \frac{dx}{y}\\&=\frac{1}{y^2+x^2}\int  \frac{y\ dx-x\ dy}{y^2}\\&=\frac{1}{y^2+x^2}\int d \left( \frac{x}y{} \right)\\&=\frac{1}{y^2+x^2} \frac{x}{y}
\end{aligned}
$$

总结一下就是

$$
\int \frac{dx}{y^3}=\left\{\begin{aligned}
\frac{1}{y^2-x^2} \frac{x}{y}\ \ [Im] \\ \\
\frac{1}{y^2+x^2} \frac{x}{y}\  \ [Re]
\end{aligned}\right. \tag2
$$

:::info

注意这里的 $y^2-x^2,y^2+x^2$ 实际上是等于常数，也就是不需要区分符号了。

:::

**小练一下**

$$
\int  \frac{d(\sin x)}{\sqrt{ (a^2-\sin^2x)^3 }}=\frac{1}{a^2} \frac{\sin x}{\sqrt{ a^2-\sin^2x }}
$$

$$
\int \frac{d(x^2023)}{\sqrt{ (4+x^{4046})^3 }}=\frac{1}{4} \frac{x^{2023}}{\sqrt{ 4+x^{4046} }}
$$

## 补充公式

$$
\begin{aligned}

\int y \, dx &=\frac{1}{2}\int y \, dx +x\ dy+\frac{1}{2}\int y \, dx -x\ dy\\&=\frac{1}{2}yx+\frac{y^2\pm x^2}{2}\int \frac{y\ dx-x\ dy}{y^2\pm x^2}  \\
&=\frac{1}{2}yx+ \frac{y^2\pm x^2}{2} \int \frac{dx}{y}
\end{aligned}
$$

## 最平凡的双元

$$
x,y=\left\{\begin{aligned}
\sqrt{ x^2+a^2 }\ [Im] \\
\sqrt{ a^2-x^2 }\ [Re] \\
\sqrt{ x^2-a^2 }\ [Im]
\end{aligned} \right.
$$
## 起手式